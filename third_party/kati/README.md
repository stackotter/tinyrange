Pulled from https://github.com/google/kati/tree/29a3410d629635008e2d5574be280e3c74b4bddc